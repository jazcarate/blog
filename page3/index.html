<!DOCTYPE html>
<html lang="en">
<head>
    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-689SEV7MTT"></script>
    <script>window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date()); gtag('config', 'G-689SEV7MTT', { cookie_domain: 'blog.florius.com.ar', cookie_flags: 'SameSite=None;Secure' });</script>
    
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <link rel="dns-prefetch" href="//fonts.googleapis.com">
    <link rel="dns-prefetch" href="//fonts.gstatic.com">
    <link rel="dns-prefetch" href="//maxcdn.bootstrapcdn.com">
    <link rel="dns-prefetch" href="//cdnjs.cloudflare.com">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="manifest" type="application/manifest+json; charset=utf-8" href="/site.webmanifest" />
    <meta name="robots" content="all">
    <meta name="author" content="florius">
    
    
    <link rel="alternate" type="application/rss+xml" title="RSS Feed for Florius‚Äô Blog" href="/feed.xml" />
    <!-- Begin Jekyll SEO tag v2.7.1 -->
<title>3 / 3 | Florius‚Äô Blog | Joaquin ‚ÄòFlorius‚Äô Azcarate‚Äôs personal blog</title>
<meta name="generator" content="Jekyll v4.2.0" />
<meta property="og:title" content="Florius‚Äô Blog" />
<meta name="author" content="Joaquin 'Florius' Azcarate" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Joaquin ‚ÄòFlorius‚Äô Azcarate‚Äôs personal blog" />
<meta property="og:description" content="Joaquin ‚ÄòFlorius‚Äô Azcarate‚Äôs personal blog" />
<link rel="canonical" href="https://blog.florius.com.ar/page3/" />
<meta property="og:url" content="https://blog.florius.com.ar/page3/" />
<meta property="og:site_name" content="Florius‚Äô Blog" />
<link rel="prev" href="https://blog.florius.com.ar/page2" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Florius‚Äô Blog" />
<meta name="twitter:site" content="@FloriusWasTaken" />
<meta name="twitter:creator" content="@FloriusWasTaken" />
<script type="application/ld+json">
{"author":{"@type":"Person","name":"Joaquin 'Florius' Azcarate"},"description":"Joaquin ‚ÄòFlorius‚Äô Azcarate‚Äôs personal blog","url":"https://blog.florius.com.ar/page3/","@type":"WebPage","headline":"Florius‚Äô Blog","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/pixyll.css?202105221927" type="text/css">

    <!-- Fonts -->
    <link href="//fonts.googleapis.com/css?family=Karla|Montserrat&amp;display=swap" rel="stylesheet">
    
    <script src="//kit.fontawesome.com/88434a0a24.js" crossorigin="anonymous" async></script>
    

    <!-- MathJax -->
    

    <!-- Verifications -->
    
    

    <!-- Icons -->
    <link rel="shortcut icon" href="/favicon.ico">
    <link rel="apple-touch-icon" sizes="180x180" href="/assets/ad1057-a6aac8d4d9cf0342b7e115ea53616d6a5afb1313ec6a57e83a84beb808e1fae4ee67fe0c3e238e83fcbb1c87bde45c5107a2a2b40dc9ffa7fee8542ebf136cf5.png" />
    <link rel="icon" type="image/png" sizes="32x32" href="/assets/03f085-c676bf2d45ffca0f725f25edeb999c44c9534e301c22f8bc99fdd6bea4103085da0b69afb67d53faddfb5a1de949f2b4e8ee8db11c788f08e051fa01c30f6f2c.png" />
    <link rel="icon" type="image/png" sizes="16x16" href="/assets/7b553b-89933b2e67e343c6c757370e6025c705cf6c5c94b33dc419fdafee38aaa8741b856c0049fe06d1da87e5bdf8a86ee0d713bdf2ee7694cdcb639c44ecbe247bd1.png"/>

    <meta name="theme-color" content="#000000">

    
</head>

<body class="site">
	

  <div class="site-wrap">
    <header class="site-header px2 px-responsive">
  <div class="mt2 wrap">
    <div class="measure">
      <a href="/" class="site-title">Florius‚Äô Blog</a>
      <nav class="site-nav">
        



    
    
    
    

    

    
    
    
    
        <a class="nav-link" href="/about/">About</a>
    

    

    
    
    
    
        <a class="nav-link" href="/categories/">Categories</a>
    

    

    
    
    
    

    

    
    
    
    

    

    
    
    
    

    

    
    
    
    

    

    
    
    
    

    

    
    
    
    

    

    
    
    
    

    

    
    
    
    

    

    
    
    
    

    

    
    
    
    

    

    
    
    
    

    


      </nav>
      <div class="clearfix"></div>
      
        <div class="social-icons">
  <div class="social-icons-right">
    
      <a class="fa fa-github" href="https://github.com/jazcarate"></a>
    
    
      <a class="fa fa-gitlab" href="https://gitlab.com/jazcarate"></a>
    
    
    
    
    
    
    
    
    
    
      <a class="fa fa-envelope" href="mailto:j@florius.com.ar"></a>
    
    
      <a class="fa fa-linkedin" href="https://www.linkedin.com/in/joaquin-azcarate"></a>
    
    
    <a class="fab fa-dev" href="https://dev.to/florius"></a>
    
    
    
    
    
  </div>
  <div class="right">
    
    
    
  </div>
</div>
<div class="clearfix"></div>

      
    </div>
  </div>
</header>


    <div class="post p2 p-responsive wrap animated fade-in-down" role="main">
      <div class="measure">
        

<div class="home">
  
    <div class="posts">
      
        <div class="post py3">
          <p class="post-meta">
	    
	      Jul 10, 2019
	    
	        </p>
          <a href="/xpost/2019/07/10/the-essence-of-event-sourcing/" class="post-link"><h3 class="h1 post-title">The essence of Event Sourcing</h3></a>
          <span class="post-summary">
            <p><em>Original post can be found in the <a href="https://blog.10pines.com/2019/07/10/the-essence-of-event-sourcing/">10Pines blog</a>.</em></p>

<p>Event Sourcing is a somewhat trending topic, but by no accounts a new one. Right now you can find a lot of stories on how to event Source in Rust, Kafka or PostgreSQL, but I‚Äôve found a lack of high concept blog posts on what <strong>is</strong> event sourcing‚Ä¶ or rather, I‚Äôve found an overwhelming amount of supposedly event sourcing posts, all talking about a lot of different things (I‚Äôm looking at you CQRS).</p>

<script type="text/javascript" src="https://ssl.gstatic.com/trends_nrtr/2431_RC04/embed_loader.js"></script>

<script type="text/javascript">trends.embed.renderExploreWidget("TIMESERIES", {"comparisonItem":[{"keyword":"Event Sourcing","geo":"","time":"today 5-y"}],"category":0,"property":""}, {"exploreQuery":"date=today%205-y&q=Event%20Sourcing","guestPath":"https://trends.google.com:443/trends/embed/"});</script>

<p>So, I‚Äôll throw my wrench in the works and try to explain what I see as ‚ÄúEvent Sourcing‚Äù, not by actually going into any technical details, but rather into how we solve a problem on that subject.</p>

<h2 id="backstory-sourcing-events">Backstory (Sourcing Events)</h2>

<p>We had a small internal app that we used in big meetings to serialize conversations. Think of it as an over-complicated, over-designed queue. The app had a backend and a frontend, both which shared the particular state that the app should show to the user.</p>

<p>Basically: Who was talking, and who comes next.</p>

<p>The app kept all of our smartphones in sync. Whenever someone, say Joe, pushed the ‚ÄúI want to talk next‚Äù button, the backend did all the computations to add him to the end of the queue, and all of our smartphones got the message with the new state to display. Joe was now on the queue. Waiting.</p>

<p>This was good enough for several meetings but we, as a tech savvy company, wanted more! So, of course, we added features like emoji support to üëç, üëé and ask that the speaker would wrap up (üåØ).</p>

<p>So far, no Events to be Sourced whatsoever.</p>

<p>After a new round of emoji-enhanced meetings, I wondered: How many üëç did I had when I spoke last week?</p>

<p>I had no way of knowing. The backend was <em>updating</em> the list of reactions every time a new speaker‚Äôs turn was up. And therein laid my problem. I never considered that after the meeting I might want to know something as simple as that.</p>

<p>So we put on our thinking hats and settled on a simple heuristic:</p>

<p><strong>No Updates. No Deletes.</strong></p>

<h2 id="the-actual-potato-eventing-source">The actual potato (Eventing Source)</h2>

<p>No Updates, no deletes might look like a daunting feat. How would we <a href="https://blog.10pines.com/2019/05/27/reifying-problems-in-our-software/">reflect reality</a> without the basic premise that <strong>things change</strong>. Luckily, we have functional programing close to our hearts here at 10Pines, and we can imagine a world where ‚Äúthings are immutable‚Äù.</p>

<p>So we had a frontend that was sending the intentions. What the user wanted to do. I will call this intentions <strong>Events</strong>.</p>

<p>We had 3 major events:</p>

<ul>
  <li>‚ÄúI want to talk‚Äù event.</li>
  <li>‚ÄúI don‚Äôt want to talk anymore‚Äù event</li>
  <li>‚ÄúI want to react with a üëç‚Äù event</li>
</ul>

<p>Notice this were not <em>‚ÄúAdd me to the queue‚Äù</em>, or <em>‚ÄúNow the speaker has 5 üëç‚Äù</em>, but rather the intention the user had.</p>

<p>Now, the backend had to receive these events, and instead of <strong>updating</strong> its state, saving it and broadcasting it; we were saving the event and computing a new state (based on the previous state and this new event)</p>

<table>
  <thead>
    <tr>
      <th>Previous state</th>
      <th>Event</th>
      <th>Current state</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">{ currentSpeaker: Joaco, queue: [] }</code></td>
      <td>Dave wants to talk</td>
      <td><code class="language-plaintext highlighter-rouge">{ currentSpeaker: Joaco, queue: [Dave] }</code></td>
    </tr>
  </tbody>
</table>

<p>And, you guessed it: the previous state was <strong>itself</strong> computed with its previous state plus the last event before this new one. So on and so forth.</p>

<table>
  <thead>
    <tr>
      <th>Previous-previous state</th>
      <th>Event</th>
      <th>Previous state</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">{ currentSpeaker: nil, queue: [] }</code></td>
      <td>Joaco wants to talk</td>
      <td><code class="language-plaintext highlighter-rouge">{ currentSpeaker: Joaco, queue: [] }</code></td>
    </tr>
  </tbody>
</table>

<p>We changed from a state that was being updated, to adding onto a list events, and finding out the new state computing every event and how they changed the state. No information can be lost. Ever. <strong>No updates. No deletes.</strong></p>

<h2 id="back-to-the-original-question-source-event">Back to the original question (Source Event)</h2>

<p>How many reactions did I have. Well, now I could figure this out. I just needed to replay all the events, but now, instead of having a state that had the whole queue, I‚Äôd use the events to transform a different, more useful state:</p>

<table>
  <thead>
    <tr>
      <th>A state</th>
      <th>Event</th>
      <th>New state</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">{ reactions_joaco_had: 0 }</code></td>
      <td>Joaco wants to talk</td>
      <td><code class="language-plaintext highlighter-rouge">{ reactions_joaco_had: 0 }</code></td>
    </tr>
  </tbody>
</table>

<table>
  <thead>
    <tr>
      <th>A state</th>
      <th>Event</th>
      <th>New state</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">{ reactions_joaco_had: 0 }</code></td>
      <td>I want to react with a üëç</td>
      <td><code class="language-plaintext highlighter-rouge">{ reactions_joaco_had: 1 }</code></td>
    </tr>
  </tbody>
</table>

<p><em>*This is an oversimplification because we would still need to know who was talking at the time to know if we had to increment the reaction counter or not.</em></p>

<p>This is called a projection, and it is the way we can ‚Äúfold‚Äù our events into relevant information.</p>

<h2 id="lets-recap-evented-source">Lets recap (Evented Source)</h2>

<p>We changed the way we thought of our storage. Rather than update what we know, we add to an infinite list the events that change our domain.</p>

<p>This way, we can <em>replay</em> those events and answer questions we never thought we wanted to ask at the time of writing the code.</p>

<h2 id="food-for-thought">Food for thought:</h2>

<p>I wanted to keep this post short and high-concept; but I‚Äôll let the reader think of some interesting things that steam from this kind of approach:</p>

<ul>
  <li>If we ever botched the part of the system that computed new states; we could rollout a fixed version, and replay the whole history of the application, and the error would cease to exist.</li>
  <li>Structural changes to the database stop being something to worry about. We are only storing events, and those don‚Äôt change often. Rolling back and replaying the history is the fabric of event sourcing.</li>
  <li>The new state doesn‚Äôt need to be computed from the first initial state, along with all the events thereafter. We can periodically take ‚Äúsnapshots‚Äù of events, and compute newer events from that saved state.</li>
  <li>The same stream of events can be used by many applications, each having their own projection to answer a wildly different set of questions.</li>
</ul>


          </span>
          
            <span class="related-categories">
            
              <a href="/categories#xpost">#xpost</a>
            
            </span>
          
        </div>
      
        <div class="post py3">
          <p class="post-meta">
	    
	      Feb 27, 2019
	    
	        </p>
          <a href="/xpost/mtg/2019/02/27/cuando-intervenir-en-un-juego/" class="post-link"><h3 class="h1 post-title">Cu√°ndo intervenir en un juego</h3></a>
          <span class="post-summary">
            <p><em>El post original se puede leer en el blog de <a href="https://blogs.magicjudges.org/latam/2019/02/27/cuando-intervenir-en-un-juego-por-joaquin-azcarate/">Jueces Hispanoamericanos</a>.</em></p>

<p>Les quiero contar una pesadilla recurrente que tengo:</p>

<blockquote>
  <p>Estoy jueceando. Escucho dos jugadores, gritando, acusarse de tramposos. Corro a ver qu√© est√° pasando. En el camino entre las mesas, que parece interminable, veo a alguien enderezar sus tierras y su Dark Confidant, robar solo una carta y jugar una tierra.</p>
</blockquote>

<p>Durante mucho de mi jueceo, tuve este conflicto interno de cu√°ndo intervenir en un partido de Magic, o si siquiera hacerlo! Una persona mucho m√°s inteligente que yo una vez me dijo: Si alguna vez no sabes algo, escrib√≠ un post al respecto. As√≠ que aqu√≠ estoy.  La respuesta a la pregunta de si ¬øDebo intervenir?, como muchas otras respuestas en la vida es ‚Äúdepende‚Äù.</p>

<h2 id="depende-el-nivel-de-imposici√≥n-de-reglas">Depende el nivel de imposici√≥n de reglas.</h2>

<p>En un torneo de donde el Nivel de Imposici√≥n de Reglas (NIR) es Normal, citando al documento de ‚ÄúJuzgando a Nivel de Imposici√≥n de Reglas Normal‚Äù (NIR):</p>

<blockquote>
  <p>Deber√≠as intervenir si ves que sucede algo ilegal en una partida, pero m√°s all√° de eso puedes <strong>usar tu criterio</strong>.</p>
</blockquote>

<p>Tambi√©n debemos tener en cuenta el tenor propio del evento. Por suerte se explaya sobre qu√© criterio deber√≠a uno usar para decidir su criterio de intervenir.</p>

<blockquote>
  <p>Por ejemplo, que intervengas cuando un jugador olvida un disparo deber√≠a estar determinado por el tenor que le quieres dar al evento; podr√≠a ser apropiado dar un poco de ayuda adicional en un entorno m√°s casual, pero no tanto si tu grupo de juego es m√°s competitivo.</p>
</blockquote>

<p>No hay una mejor forma de ponerlo, y no hay una respuesta √≠ntegramente incorrecta sobre cu√°ndo intervenir. Tu eres quien mejor conoce a tus jugadores. Haz lo que te parezca m√°s correcto en cada situaci√≥n, y si los jugadores se sienten avasallados o dejados a la deriva, toma acciones correctivas en cualquiera de las dos direcciones. Siempre recordando que como jueces debemos ser √°rbitros neutrales y alentar una atm√≥sfera cordial y una competencia amistosa.</p>

<h2 id="y-en-competitivo">¬øY en competitivo?</h2>

<p>Por suerte en torneos con un REL competitivo muchas de estas dicotom√≠as est√°n resueltas. La Gu√≠a de Procedimientos de Infracciones nos dice claramente en su segundo p√°rrafos:</p>

<blockquote>
  <p>Un juez no deber√≠a intervenir en un juego a menos que crea que ocurri√≥ una violaci√≥n de reglas, un jugador con una pregunta o preocupaci√≥n solicita asistencia, o el juez desea evitar que una situaci√≥n empeore.</p>
</blockquote>

<p>Las primera premisas es suficientemente f√°ciles de entender.</p>

<blockquote>
  <p>‚Ä¶ crea que ocurri√≥ una violaci√≥n de reglas‚Ä¶</p>
</blockquote>

<p>Para esto tenemos todo el compendio de reglas de Magic para ser quebrantadas. El pr√≥ximo p√°rrafo de la gu√≠a justamente v√° sobre este t√≥pico, siguiendo</p>

<blockquote>
  <p>Los jueces no evitan que sucedan los errores de juego, sino que lidian con errores que ocurrieron, penalizan a aquellos que violan las reglas o pol√≠ticas y promueven el juego limpio y la conducta deportiva con el ejemplo y la diplomacia.</p>
</blockquote>

<p>Pero ya la segunda tiene su vericueto.</p>

<blockquote>
  <p>‚Ä¶ un jugador con una pregunta o preocupaci√≥n solicita asistencia‚Ä¶</p>
</blockquote>

<p>A lo lejos se escucha un √°rbol golpear contra una ventana, pero uno solo escucha ‚ÄúJuez!!‚Äù.</p>

<p>Pero, qu√© hay de esas veces en donde vemos un jugador a lo lejos con cara de confusi√≥n y desesperaci√≥n. Todav√≠a no llam√≥ a un Juez, pero tal vez ni siquiera lo haga si no v√© a ning√∫n juez alrededor. ¬øDebemos acercarnos? ¬°Estar√≠amos entrometidos con la misma esencia del continuo espacio tiempo!‚Ä¶ No. Esto es parte de brindar aquel elusivo ‚Äúservicio al cliente‚Äù. Debemos ser vistos como personas neutrales, pero tambi√©n tenemos que intentar brindar una experiencia grata a todos los jugadores. Lo que nos lleva a la tercera y ultima parte:</p>

<blockquote>
  <p>‚Ä¶  el juez desea evitar que una situaci√≥n empeore.</p>
</blockquote>

<p>Lo que hay que entender, y las anotaciones de la Gu√≠a nos ayudan a esto, es que esta situaci√≥n a empeorar es una ‚Äúsituaci√≥n delicada como una discusi√≥n‚Äù, no un campo de batalla con 60 criaturas, o un stack con 7 hechizos contrarrestando entre ellos, si no cuando la situaci√≥n podr√≠a bien encuadrar en la definici√≥n de conducta antideportiva.</p>

<h2 id="algunas-situaciones">Algunas situaciones</h2>

<p>Dos buenos amigos (Nick y Audrey) est√°n jugando en un FNM. Audrey juega una criatura, en lo que Nick responde con un [Absorber] contrarrestando. La criatura va al cementerio y Audrey pasa su turno. Nick endereza sus tierras, y en ese momento se d√° cuenta que se olvid√≥ de ganar 3 vidas por el Absorber. Tu escuchas a Nick decir esto y te acercas a la mesa inconspicuamente.</p>

<p>Notas que el hechizo de Absorber no fue correctamente resuelto, pero los jugadores parecer√≠an continuar jugando. ¬øIntervienes? ‚Äì ¬°Si!</p>

<blockquote>
  <p>Deber√≠as intervenir si ves que sucede algo <strong>ilegal</strong> en una partida‚Ä¶</p>
</blockquote>

<p>D√°ndose cuenta de su error, los jugadores anotan que Nick gan√≥ 3 vidas, y contin√∫an jugando. ¬øIntervienes? ‚Äì ¬°No! A lo sumo, de la manera menos intrusiva posible, puedes recordarles que jueguen con m√°s cuidado.</p>

<p>Misma situaci√≥n, pero los jugadores r√°pidamente anotan que Nick gan√≥ 3 vidas convenciendose que si estuviesen en un Magic Fest, la habilidad disparada del Absor no podr√≠a perderse, porque pasaron menos de 3 turnos. Notas que la justificaci√≥n por la cual corrigieron el estado del juego es err√≥nea. ¬øIntervienes? ¬°Si!</p>

<blockquote>
  <p>Nuestras soluciones deber√≠an focalizarse en <strong>educar</strong> a los jugadores</p>
</blockquote>

<p>Observas a un jugador barajar su mazo al final del primer partido en un Grand Prix, y te percatas de que una criatura previamente exiliada est√° en la mesa y el jugador olvid√≥ barajar dicha carta en su mazo. ¬øIntervienes? ¬°Si! Este ejemplo viene directo de la gu√≠a anotada. Lo importante a destacar de esta situaci√≥n, es que el error se pudo detectar ‚Äúfuera del juego‚Äù</p>

<blockquote>
  <p>Los jueces pueden intervenir para prevenir o evitar errores que ocurren fuera de un juego.</p>
</blockquote>

<p>Ese mismo jugador sus tierras solo 17,3 grados para producir man√°.¬øIntervienes? ‚Äì ¬°Si! Por suerte, la gu√≠a de infracciones aclara que como jueces, podemos  solicitar a los jugadores que aclaren la situaci√≥n, incluso si los jugadores est√°n jugando de manera clara para ellos. Si pudiese confundir a un observador externo.</p>

<p>Si llegaron a leer hasta ac√°; ignoren este √∫ltimo ejemplo. Much√≠simas gracias y siganla rockeando.</p>

          </span>
          
            <span class="related-categories">
            
              <a href="/categories#xpost">#xpost</a>
            
              <a href="/categories#mtg">#mtg</a>
            
            </span>
          
        </div>
      
        <div class="post py3">
          <p class="post-meta">
	    
	      Aug 14, 2018
	    
	        </p>
          <a href="/xpost/2018/08/14/limit-problem-space/" class="post-link"><h3 class="h1 post-title">Limit the Problem Space!</h3></a>
          <span class="post-summary">
            <p><em>Original post can be found in the <a href="https://blog.10pines.com/2018/08/14/limit-problem-space/">10Pines blog</a>.</em></p>

<h2 id="write-less-error-prone-code">Write less error-prone code.</h2>

<p>First things first: What is the problem space?
Simply put, it is the entire spectrum of inputs that exists in the process of finding a solution to a problem.
Say you want to buy a soda from a vending machine. You now have a problem to solve: ‚ÄúDecide what beverage to purchase‚Äù. Every button is part of the problem space; yet you can narrow it down to just buttons that get you a can.</p>

<h2 id="down-to-business">Down to business</h2>

<p>In order to present my idea, let‚Äôs take a somewhat simple example. a TennisMatch object, that represents just that: a tennis match.</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="nc">TennisMatch</span> <span class="n">williamsVsPetrova</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">TennisMatch</span><span class="o">(...);</span></code></pre></figure>

<p>One thing that a <code class="language-plaintext highlighter-rouge">TennisMatch</code> should keep track of is its score. Let‚Äôs assume the match is responsible of doing this with a <code class="language-plaintext highlighter-rouge">score</code> method. We have several design options:</p>

<ol>
  <li><code class="language-plaintext highlighter-rouge">williamsVsPetrova.score('williams')</code> / <code class="language-plaintext highlighter-rouge">williamsVsPetrova.score('player1')</code></li>
  <li><code class="language-plaintext highlighter-rouge">williamsVsPetrova.score(0)</code></li>
  <li><code class="language-plaintext highlighter-rouge">williamsVsPetrova.scorePlayer1()</code></li>
</ol>

<p>Most of the times, we‚Äôd go for alternative 1 or 2. This makes our code look something like this:</p>

<p><em>Please bear with me for the sake of this example, because we are going to be using a dictionary with the player (whichever their representation: <code class="language-plaintext highlighter-rouge">String</code>, <code class="language-plaintext highlighter-rouge">Integer</code> or <code class="language-plaintext highlighter-rouge">Player</code>) as the key, and their score as the value. This decision in and of itself is not important, but rather a way to scaffold the point I‚Äôm trying to get across.</em></p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">TennisMatch</span> <span class="o">{</span>
    <span class="kd">private</span> <span class="nc">Map</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">,</span> <span class="nc">Point</span><span class="o">&gt;</span> <span class="n">points</span><span class="o">;</span>
    <span class="o">...</span>
    
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">score</span><span class="o">(</span><span class="nc">String</span> <span class="n">player</span><span class="o">)</span> <span class="o">{</span>
        <span class="n">points</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">player</span><span class="o">).</span><span class="na">scoreAPoint</span><span class="o">();</span>
    <span class="o">}</span>
<span class="o">}</span></code></pre></figure>

<p>Which would lead to several unwanted ramifications:
What if‚Ä¶</p>

<ul>
  <li>the <code class="language-plaintext highlighter-rouge">player</code> parameter is not in our <code class="language-plaintext highlighter-rouge">Map</code>?</li>
  <li>the player is null?</li>
  <li>the player key is in the <code class="language-plaintext highlighter-rouge">Map</code>, but the value of the map is <code class="language-plaintext highlighter-rouge">null</code>?</li>
</ul>

<p>Before talking about how can we can improve our code, let‚Äôs take a minute to think how the latter in particular might be easily fixed.</p>

<p>We could avoid it altogether (and maybe the other ones) by forcing the <code class="language-plaintext highlighter-rouge">TennisMatch</code> creation to have two players and making those players have a valid starting score.</p>

<h2 id="maths">Maths!</h2>

<p>Let‚Äôs jump briefly to another situation.</p>

<p>Suppose that we wanted to solve the following problem:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>If we have 3 minutes for a presentation,
and we need to equally divide them between n students,
how many minutes would each student get?
</code></pre></div></div>

<p>A method that would solve this problem might look something like this:</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="n">superDivide</span><span class="o">(</span><span class="nc">Object</span> <span class="n">amountOfStudents</span><span class="o">)</span> <span class="o">{</span> 
  <span class="k">return</span> <span class="mi">3</span> <span class="o">/</span> <span class="o">((</span><span class="nc">Integer</span><span class="o">)</span> <span class="n">amountOfStudents</span><span class="o">);</span>
<span class="o">}</span></code></pre></figure>

<p>Of course, it doesn‚Äôt make much sense to accept an <code class="language-plaintext highlighter-rouge">Object</code> in the method signature, since we already know we are going to be dealing with numbers. And, mind you, because <a href="https://en.wikipedia.org/wiki/Downcasting">downcasting</a> stinks.</p>

<p>So, based on what we already know, we could avoid downcasting, limiting the possible inputs from <code class="language-plaintext highlighter-rouge">Object</code> to <code class="language-plaintext highlighter-rouge">Integer</code>:</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="n">superDivide</span><span class="o">(</span><span class="nc">Integer</span> <span class="n">amountOfStudents</span><span class="o">)</span> <span class="o">{</span>
  <span class="k">return</span> <span class="mi">3</span> <span class="o">/</span> <span class="n">amountOfStudents</span><span class="o">;</span>
<span class="o">}</span></code></pre></figure>

<p>I‚Äôd ponder this is not much better.
With a keen eye for finding problems, one might realize that if the parameter were <code class="language-plaintext highlighter-rouge">0</code>, the program would explode.
Say this is not what we want, because we know that we are dealing with an amount of students, <code class="language-plaintext highlighter-rouge">n</code>. And <code class="language-plaintext highlighter-rouge">n</code> should never be zero. <em>Nor should it be less than zero</em>.
This suggests to me that our method is accepting a problem space much much larger than what we actually can and should be able to handle.</p>

<p>We could take two paths to fix this:</p>

<ul>
  <li>Preparing for the worse and checking for this restrictions to be met inside our method</li>
</ul>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="n">superDivide</span><span class="o">(</span><span class="nc">Integer</span> <span class="n">amountOfStudents</span><span class="o">)</span> <span class="o">{</span>
  <span class="k">if</span><span class="o">(</span> <span class="n">amountOfStudents</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="o">)</span>
    <span class="k">throw</span> <span class="k">new</span> <span class="nf">InvalidAmountOfStudents</span><span class="o">(</span><span class="n">amountOfStudents</span><span class="o">);</span>
  <span class="k">return</span> <span class="mi">3</span> <span class="o">/</span> <span class="n">amountOfStudents</span><span class="o">;</span>
<span class="o">}</span></code></pre></figure>

<ul>
  <li>Deal with the problem head on, and limit the problem space!</li>
</ul>

<p>Math has a name for this kind of numbers: <a href="https://en.wikipedia.org/wiki/Natural_number">Natural numbers</a>. Java does not. At least not out-of-the-box. But we can create the <code class="language-plaintext highlighter-rouge">NaturalNumber</code> class!</p>

<p>This way, we wouldn‚Äôt need to be prepared for those edge cases, since we‚Äôd have limited the input of our method, and deal only with valid numbers:</p>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="n">superDivide</span><span class="o">(</span><span class="nc">NaturalNumber</span> <span class="n">amountOfStudents</span><span class="o">)</span> <span class="o">{</span>
  <span class="k">return</span> <span class="mi">3</span> <span class="o">/</span> <span class="n">amountOfStudents</span><span class="o">;</span>
<span class="o">}</span></code></pre></figure>

<p>Java does not have an object to handle the filter for unauthorized users on a rest API call either, yet we are eager to create <code class="language-plaintext highlighter-rouge">UnauthorizedUserFilter implements RESTFilter</code>. I don‚Äôt usually see simple <em>problem limiting</em> classes like <code class="language-plaintext highlighter-rouge">NaturalNumber</code>. It baffles me.</p>

<h2 id="argumentative">Argumentative</h2>

<p>Back to <code class="language-plaintext highlighter-rouge">williamsVsPetrova.score</code>. Let‚Äôs think about this problem as a math <em>function</em>. Its <a href="https://en.wikipedia.org/wiki/Domain_of_a_function">domain</a> <strong>should be only two</strong> values. One for each player.
Now, lets analyze the parameter types we mentioned above:</p>

<ol>
  <li><code class="language-plaintext highlighter-rouge">public void score(</code> <code class="language-plaintext highlighter-rouge">String</code> <code class="language-plaintext highlighter-rouge">player)</code>: The <code class="language-plaintext highlighter-rouge">String</code> type is infinitely <em>(disregard limited memory problem)</em> large. So it might not be the best type.
    If we do go for this option, we will be forced to do some assertions if the name is one of the player participating in the <code class="language-plaintext highlighter-rouge">TennisMatch</code>.</li>
  <li><code class="language-plaintext highlighter-rouge">public void score(</code> <code class="language-plaintext highlighter-rouge">Integer</code> <code class="language-plaintext highlighter-rouge">player)</code>: Same as 1., but with added obfuscation. Please don‚Äôt.</li>
  <li><code class="language-plaintext highlighter-rouge">public void scorePlayer1()</code>: No parameter means the domain size is only one. We are half way there!
    We re now forced to implement public void scorePlayer2(). The code for these two methods might be conspicuously similar, so we might refactor them like so:</li>
</ol>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="kd">public</span> <span class="kt">void</span> <span class="nf">scorePlayer1</span><span class="o">()</span> <span class="o">{</span>
    <span class="n">scoreFor</span><span class="o">(</span><span class="err">'</span><span class="n">player1</span><span class="err">'</span><span class="o">);</span>
<span class="o">}</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">scorePlayer2</span><span class="o">()</span> <span class="o">{</span>
    <span class="n">scoreFor</span><span class="o">(</span><span class="err">'</span><span class="n">player2</span><span class="err">'</span><span class="o">);</span>
<span class="o">}</span>
<span class="kd">private</span> <span class="kt">void</span> <span class="nf">scoreFor</span><span class="o">(</span><span class="nc">String</span> <span class="n">scorer</span><span class="o">)</span> <span class="o">{</span>
    <span class="o">...</span>
<span class="o">}</span></code></pre></figure>

<p>Although we are using a <code class="language-plaintext highlighter-rouge">String</code> with its infinitely large domain space, the method is private and we are sure that the only possible calls are with one of two valid values.</p>

<ol>
  <li>public void score( Bool player): In spite of the fact that the the Boolean type might fit our domain-length restrictions; think about how it will look like when used:</li>
</ol>

<figure class="highlight"><pre><code class="language-java" data-lang="java"><span class="n">williamsVsPetrova</span><span class="o">.</span><span class="na">score</span><span class="o">(</span><span class="kc">false</span><span class="o">);</span> <span class="c1">//Ball for Petrova ?!</span></code></pre></figure>

<h2 id="a-side-note-on-the-language">A side note on the language</h2>

<p>I used Java throughout the post, and although I took advantage of the fact that Java is <a href="https://en.wikipedia.org/wiki/Type_system#Static_type_checking">strongly and explicitly typed with static type checking</a>, this principles are not language-specific.</p>

<h2 id="bonus-make-the-problem-space-explicit">Bonus: Make the problem space explicit!</h2>

<p>Since a method can have its argument either <code class="language-plaintext highlighter-rouge">null</code> or an actual value; rather than have a comment, use a <code class="language-plaintext highlighter-rouge">type</code> that represents both cases <em>(<code class="language-plaintext highlighter-rouge">Optionals</code> in the case of Java)</em>.</p>

<h2 id="recap">Recap</h2>

<ul>
  <li><a href="https://en.wikipedia.org/wiki/Constructor_(object-oriented_programming)">Constructors</a> are important. If you can‚Äôt build invalid objects, then you can write code assuming the objects you interact with are valid. This can save you many headaches.</li>
  <li>Don‚Äôt be afraid of creating classes with the sole purpose of delimiting your problem space.</li>
  <li>Thinking about the domain space of a method, albeit a good technique, is not the only one. Think of it as an extra tool in your tool belt.</li>
</ul>

          </span>
          
            <span class="related-categories">
            
              <a href="/categories#xpost">#xpost</a>
            
            </span>
          
        </div>
      
    </div>

    
<div class="pagination clearfix mb1 mt4">
  <div class="left">
    
      
        <a class="pagination-item" href="/page2">Older</a>
      
    
  </div>
  <div class="right">
    
      <span class="pagination-item disabled">Older</span>
    
  </div>
  <div class="pagination-meta">Page 3 of 3</div>
</div>


  
</div>

      </div>
    </div>
  </div>

  <footer class="center">
  <div class="measure">
    <small>
      Theme heavily inspired in <a href="http://johnotander.com">John Otander</a>' <a href="https://github.com/johno/pixyll">pixyll</a>.
    </small>
  </div>
</footer>
<!-- AnchorJS -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.2.0/anchor.min.js"></script>
<script>
    anchors.options.visible = 'touch';
    anchors.add('article h2, article h3, article h4, article h5, article h6');
</script>

</body>
</html>
